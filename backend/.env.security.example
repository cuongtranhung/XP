# Security Configuration for Multi-User Form Builder
# Copy this to .env and adjust values as needed

# Rate Limiting Configuration
FORM_CREATION_RATE_LIMIT=20
FORM_SUBMISSION_RATE_LIMIT=50
PUBLIC_STATS_RATE_LIMIT=200
FORM_CLONING_RATE_LIMIT=10
DATA_EXPORT_RATE_LIMIT=5
FORM_UPDATE_RATE_LIMIT=100
BULK_OPERATIONS_RATE_LIMIT=10

# Authentication Rate Limiting
LOGIN_RATE_LIMIT=5
REGISTER_RATE_LIMIT=3
FORGOT_PASSWORD_RATE_LIMIT=3
RESET_PASSWORD_RATE_LIMIT=5
GENERAL_RATE_LIMIT=100

# Security Settings
MAX_REQUEST_SIZE=10485760  # 10MB in bytes
SESSION_SECRET=your-super-secure-session-secret-here
JWT_SECRET=your-jwt-secret-here
CSRF_SECRET=your-csrf-secret-here

# CORS Configuration
FRONTEND_URL=http://localhost:3000
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,https://yourdomain.com

# File Upload Security
MAX_FILE_SIZE=10485760  # 10MB
ALLOWED_FILE_TYPES=text/csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/json,text/plain

# IP Whitelist (comma-separated, optional)
# ADMIN_IP_WHITELIST=192.168.1.1,10.0.0.1
# EXPORT_IP_WHITELIST=192.168.1.100,192.168.1.101

# Security Headers
HSTS_MAX_AGE=31536000
ENABLE_CSP=true
ENABLE_FRAME_GUARD=true

# Logging Level
LOG_LEVEL=info
SECURITY_LOG_LEVEL=warn

# Database Security
DB_CONNECTION_LIMIT=20
DB_IDLE_TIMEOUT=30000

# Redis Configuration (for advanced rate limiting)
REDIS_URL=redis://localhost:6379
REDIS_PREFIX=formbuilder:

# Monitoring and Alerts
ENABLE_SECURITY_MONITORING=true
ALERT_EMAIL=admin@yourcompany.com
WEBHOOK_SECURITY_ALERTS=https://your-monitoring-service.com/webhook

# Environment
NODE_ENV=production